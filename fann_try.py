from __future__ import division
from pyfann import libfann

def load_test_set(filename):
	my_file = open(filename, "r")

	header = None
	rownum = 0

	test_set = []
	output = []

	for row in my_file:
		#(emotion, pixel_list, usage)
		splitted = row.split()
		if rownum%2 == 0:
			test_set.append(map(int,splitted))
		else:
			output.append(map(int,splitted))

		rownum += 1

	my_file.close()

	return test_set,output

test,output = load_test_set('fann_test.data')
#print len(test),len(output)
ann = libfann.neural_net()
ann.create_from_file("fann_result_train92.net")

correct = 0
acc = 0

# o = ann.run([107,107,109,109,109,109,110,101,123,140,144,144,149,153,160,161,161,167,168,169,172,172,173,175,176,171,170,166,165,162,162,157,150,149,145,140,136,132,128,111,98,111,109,107,107,107,107,107,107,107,109,109,109,110,107,109,131,141,139,143,149,153,160,164,166,168,169,169,172,172,176,177,178,173,171,170,168,164,161,159,155,148,145,142,136,132,129,123,98,103,110,107,107,107,107,107,107,107,108,109,108,110,102,118,131,136,138,143,146,153,159,165,169,169,171,176,178,179,184,184,191,185,174,173,171,172,166,161,157,152,149,144,139,132,130,125,110,93,110,106,107,107,107,107,107,108,108,108,108,109,106,125,127,133,135,142,146,153,162,167,169,175,177,180,180,184,185,184,194,192,179,177,170,170,168,160,158,156,150,144,136,134,133,123,121,100,105,108,107,107,106,106,107,108,108,108,109,108,113,128,125,132,137,141,150,154,160,163,167,173,178,181,177,182,186,190,198,197,185,174,171,172,171,163,160,155,147,143,139,136,133,120,119,106,99,109,106,106,106,106,108,107,107,108,110,105,114,125,123,127,137,141,148,153,158,168,169,173,182,186,181,181,190,196,197,192,182,167,167,171,172,167,163,156,149,144,136,138,136,124,120,114,95,108,107,106,106,106,108,107,107,109,110,107,116,121,122,127,137,144,150,158,162,167,173,176,179,183,181,180,186,189,187,187,181,170,171,174,171,163,159,155,148,143,138,137,138,125,121,121,99,105,107,106,106,106,107,107,107,108,108,104,118,122,121,130,141,145,148,151,159,164,167,173,176,180,180,181,183,185,186,194,192,176,178,180,173,166,161,155,147,140,141,141,140,129,118,121,106,102,107,105,105,105,106,107,107,108,105,104,117,121,117,125,142,142,148,158,166,171,175,179,181,184,188,189,186,179,178,192,193,185,183,185,177,169,166,157,143,141,144,143,139,124,119,120,109,103,105,104,103,103,106,107,107,109,100,104,118,117,115,123,143,145,144,152,158,166,175,178,182,187,191,192,190,190,184,184,191,187,187,180,170,166,163,155,141,140,146,148,133,122,123,119,110,101,105,104,103,103,106,107,107,109,101,107,117,118,123,130,143,148,148,161,167,172,174,178,179,182,187,188,186,192,194,185,188,188,187,181,177,174,169,158,155,153,150,150,132,126,123,121,114,100,106,104,103,103,107,106,106,107,101,107,119,122,123,129,144,155,160,165,170,171,175,178,181,181,187,193,190,191,191,185,191,188,182,176,173,166,160,160,162,153,153,154,137,125,122,120,114,100,103,104,104,104,106,106,106,108,98,109,125,117,125,132,152,155,152,161,170,168,164,168,170,171,177,185,185,195,177,171,176,175,172,165,162,162,165,166,160,150,147,151,139,126,123,115,109,99,101,104,103,103,106,106,107,109,94,105,119,118,129,135,136,136,142,144,156,169,171,164,160,164,165,169,159,167,162,156,164,166,162,161,164,165,160,140,130,138,138,134,135,128,121,112,106,98,101,105,103,102,106,107,103,107,95,98,119,114,124,130,126,130,139,118,94,103,127,155,157,154,155,154,147,157,153,149,160,156,149,142,139,123,88,79,106,127,130,133,130,128,121,111,104,92,101,102,101,101,106,108,117,117,97,95,117,117,122,133,143,151,151,139,114,76,60,79,107,131,141,143,139,161,155,145,157,147,128,114,76,44,49,79,105,126,142,141,126,119,119,113,106,89,98,111,107,101,105,106,128,142,106,95,117,119,115,127,135,123,90,69,83,95,75,53,50,79,104,131,139,162,165,154,153,120,84,54,32,57,106,117,88,68,85,123,118,112,112,114,105,92,117,133,110,102,105,103,110,147,152,101,113,121,107,112,104,64,86,146,195,217,194,132,62,58,62,87,143,168,173,167,139,71,52,53,83,160,212,220,200,152,63,64,101,108,109,115,100,99,150,113,93,104,104,105,103,115,153,116,111,124,110,108,85,68,141,199,172,155,149,182,117,83,84,82,126,173,182,169,121,76,86,88,136,172,122,109,148,180,130,78,95,114,110,118,101,110,133,90,102,100,103,104,104,97,123,125,115,129,118,111,93,112,160,144,58,24,53,139,137,133,152,137,131,175,192,170,128,125,140,127,149,116,35,18,63,155,141,102,106,121,129,124,101,116,107,92,101,99,103,103,103,103,98,107,117,131,135,128,119,119,137,150,84,57,90,147,149,171,176,147,140,169,187,165,134,135,165,159,148,144,99,85,120,139,119,136,133,148,141,124,111,98,99,100,99,98,103,103,102,106,97,71,116,134,152,149,144,145,132,133,138,145,156,156,155,165,159,147,137,163,187,164,131,142,153,175,158,142,144,138,125,124,147,144,150,153,141,124,111,79,102,104,97,98,104,104,103,103,121,94,112,133,154,162,154,148,150,148,144,149,157,155,151,166,164,160,135,163,182,157,128,151,152,163,160,162,155,148,152,155,143,149,162,155,142,120,107,95,114,104,97,98,103,103,103,97,121,125,111,129,150,164,166,164,161,158,165,172,173,157,161,173,167,158,132,159,181,152,128,150,152,159,155,162,172,176,161,147,148,161,167,156,137,119,100,109,130,97,97,98,102,103,102,98,107,140,109,123,145,163,169,171,170,168,166,166,161,161,173,168,161,145,132,158,175,153,129,139,144,156,162,146,150,150,154,158,156,165,163,153,134,117,93,139,129,91,97,97,102,103,100,99,98,132,110,118,139,154,164,172,173,170,171,160,159,171,175,167,154,143,137,159,178,153,131,134,140,151,163,164,155,153,163,159,160,164,159,146,126,111,97,130,103,91,96,97,102,101,99,98,94,110,109,106,131,144,152,165,172,173,169,170,176,177,175,169,146,136,144,160,178,159,135,129,136,152,166,165,162,163,161,162,164,159,148,133,116,107,101,110,88,93,94,96,102,100,98,97,94,94,89,100,121,135,142,152,161,165,169,174,178,182,179,166,132,131,149,169,179,158,138,121,129,152,165,168,164,169,159,155,148,140,135,121,112,108,91,91,87,91,94,95,101,99,98,96,93,87,87,102,110,120,133,138,148,159,163,176,178,180,176,153,139,141,146,165,172,157,141,132,128,144,164,168,166,167,155,144,141,136,125,112,109,98,89,83,87,89,93,94,101,99,97,95,92,86,81,86,106,111,125,136,146,154,159,168,174,173,167,150,144,139,148,169,178,157,139,132,139,142,164,165,165,162,155,142,132,127,113,106,105,92,77,80,85,89,92,94,100,98,96,94,90,85,78,78,100,106,108,120,134,149,159,160,165,164,155,140,139,135,143,170,179,154,131,132,136,141,162,165,161,155,148,133,122,112,99,103,102,88,73,77,82,88,91,95,99,98,96,94,89,85,77,75,95,108,102,110,123,141,150,157,158,155,163,124,86,76,108,136,137,119,96,86,94,138,165,164,160,150,140,126,111,100,97,105,98,88,71,76,83,88,91,95,99,98,96,94,89,85,78,72,94,108,114,107,117,134,144,153,156,156,169,136,73,50,63,91,91,72,51,54,89,148,165,162,158,149,140,126,106,96,106,106,103,88,68,77,83,88,91,95,99,98,97,94,90,85,80,72,88,101,113,117,111,126,139,145,151,156,163,160,141,110,90,72,69,70,91,117,145,156,159,159,157,146,137,124,108,106,112,109,103,85,68,77,83,88,92,93,99,98,97,94,91,85,82,73,83,104,111,119,117,122,137,143,154,154,157,158,150,134,127,121,114,128,137,139,147,154,156,153,153,147,136,120,104,111,119,110,105,80,69,77,84,88,92,93,99,98,97,95,92,87,85,77,76,99,110,120,122,125,127,143,152,151,145,150,143,133,142,141,138,147,137,133,140,145,144,146,148,139,131,113,108,113,114,114,101,73,71,79,85,88,92,93,99,98,98,95,93,88,83,76,73,93,108,119,122,127,122,127,144,142,141,138,138,132,140,134,125,141,135,128,133,135,135,132,136,131,128,117,108,113,115,114,89,68,74,81,85,89,91,93,98,98,98,95,93,89,84,79,72,84,105,117,122,138,128,124,135,131,124,126,138,143,152,148,146,157,146,144,135,127,123,129,134,122,132,125,111,110,117,103,77,67,75,81,86,89,90,92,98,98,97,95,94,90,86,82,73,74,97,115,119,140,124,122,124,116,107,123,130,122,122,153,168,142,112,117,120,113,103,120,125,117,134,128,109,109,104,85,65,69,76,82,86,88,90,91,98,97,95,94,93,90,86,81,76,70,85,109,111,138,123,110,99,81,70,68,72,80,75,86,105,75,80,78,62,58,73,90,108,112,128,124,104,105,92,65,62,70,77,83,86,88,90,91,98,97,95,94,93,90,87,83,78,72,77,104,105,129,123,106,104,123,128,102,96,119,128,116,108,125,124,106,102,113,135,131,114,113,132,123,103,101,78,62,67,72,78,83,86,88,89,90,97,96,95,94,93,90,87,84,79,74,75,100,112,114,115,107,119,136,134,123,125,126,141,156,161,147,128,130,130,119,133,128,116,114,118,109,97,92,73,65,67,73,80,84,86,88,89,89,96,95,95,93,93,90,87,84,80,74,81,91,116,95,108,104,114,114,118,111,110,130,126,125,136,128,126,118,105,119,124,110,114,108,109,91,94,84,80,65,69,74,79,83,86,88,89,89,96,94,94,94,93,90,89,85,80,75,86,89,101,108,102,108,116,116,103,106,92,72,63,55,56,60,65,71,100,110,108,111,114,114,104,91,91,87,88,64,70,75,79,83,86,88,88,87,95,94,94,95,93,91,89,85,81,77,83,102,79,99,109,116,117,130,130,113,109,107,108,112,112,107,112,117,115,116,127,130,130,124,105,86,80,100,88,62,73,77,80,83,83,86,93,102,94,94,94,95,93,91,89,86,82,78,79,104,97,64,77,106,118,124,135,136,135,146,154,157,162,161,158,146,142,139,140,133,121,111,84,65,92,103,90,61,75,81,84,82,93,104,105,98,94,94,94,95,93,91,88,86,85,81,82,104,107,80,64,72,101,120,126,131,139,142,142,143,145,148,146,140,138,127,129,122,109,84,62,84,103,108,96,60,78,82,83,83,94,91,84,86,94,94,94,94,92,90,88,84,86,78,83,109,108,100,78,70,71,99,119,118,118,128,137,138,135,130,126,131,125,113,121,111,84,61,78,97,106,115,94,59,78,83,82,83,82,83,84,106])
# print o
# mx = o.index(max(o))
# print mx

for i in range(len(test)):
	o = ann.run(test[i])
	mx = o.index(max(o))
	target = output[i].index(1)
	print 'o',o,'m',mx,'t',target
	
	if mx == target: #happy
		correct+=1
	acc = correct/len(test)
	print acc
print 'correct', correct, 'total',len(test)
